<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Medication Tracker</title>

<style>
/* ===== åŸºç¡€å˜é‡ ===== */
:root{
  --bg:#fff5fb;
  --card:#ffffff;
  --text:#333;
  --muted:#888;
  --primary:#ff69b4;
  --accent:#ffd6e8;
}
[data-theme="blue"]{
  --bg:#eef6ff;--card:#fff;--text:#223;--muted:#667;--primary:#4da3ff;--accent:#d7ebff;
}
[data-theme="mint"]{
  --bg:#effaf6;--card:#fff;--text:#143;--muted:#587;--primary:#3ec7a1;--accent:#d9f3ea;
}
[data-theme="night"]{
  --bg:#121212;--card:#1f1f1f;--text:#eaeaea;--muted:#aaa;--primary:#8ab4f8;--accent:#2a2a2a;
}
[data-theme="minimal"]{
  --bg:#fff;--card:#fff;--text:#111;--muted:#777;--primary:#111;--accent:#f2f2f2;
}

/* ===== é€šç”¨ ===== */
body{
  margin:0;
  font-family: ui-rounded,"SF Pro Rounded","PingFang SC","Microsoft YaHei",system-ui;
  background:var(--bg);
  color:var(--text);
}
.app{
  max-width:420px;
  margin:0 auto;
  padding:16px;
}
h1{font-size:20px;margin:4px 0 12px;}
.card{
  background:var(--card);
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 6px 20px rgba(0,0,0,.06);
}
.row{display:flex;align-items:center;gap:8px;}
.space{flex:1}
button{
  border:none;
  border-radius:12px;
  padding:8px 12px;
  background:var(--primary);
  color:#fff;
  font-size:14px;
}
button.secondary{
  background:var(--accent);
  color:var(--text);
}
input{
  width:100%;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid #ddd;
}

/* ===== è£…é¥° & åŠ¨æ•ˆ ===== */
.decor-off .decor{display:none!important;}
.motion-off *{animation:none!important;transition:none!important;}

.decor{
  position:fixed;right:12px;top:12px;
  font-size:22px;opacity:.6;
}

/* ===== å¤œé—´å­—ä½“å¯è¯»ä¿®å¤ ===== */
[data-theme="night"] input{
  background:#2a2a2a;
  color:#fff;
  border:1px solid #444;
}

/* ===== ä½œè€… ===== */
.author-fixed{
  position:fixed;
  right:10px;
  bottom:8px;
  font-size:12px;
  color:var(--muted);
  opacity:.8;
  pointer-events:none;
}
</style>
</head>

<body>
<div class="decor">ğŸ€</div>

<div class="app" id="app">
  <h1>ğŸ’Š ç”¨è¯è®°å½•</h1>

  <div class="card">
    <div class="row">
      <strong id="today"></strong>
      <div class="space"></div>
      <select id="themeSel">
        <option value="kitty">Kitty</option>
        <option value="blue">Blue</option>
        <option value="mint">Mint</option>
        <option value="night">Night</option>
        <option value="minimal">Minimal</option>
      </select>
    </div>
    <div class="row" style="margin-top:8px">
      <label><input type="checkbox" id="decorToggle"> è£…é¥°</label>
      <label><input type="checkbox" id="motionToggle"> åŠ¨æ•ˆ</label>
    </div>
  </div>

  <div class="card">
    <strong>ä»Šæ—¥è¯ç‰©</strong>
    <div id="medList"></div>
    <button class="secondary" onclick="addMed()">â• æ·»åŠ è¯ç‰©</button>
  </div>

  <div class="card">
    <strong>è¡¥å½•</strong>
    <input type="date" id="backDate"/>
    <button onclick="backfill()">ç¡®è®¤è¡¥å½•</button>
  </div>
</div>

<div class="author-fixed">by FLAAAAKING</div>

<script>
/* ===== å·¥ä½œåŒº widï¼ˆæ ¸å¿ƒï¼‰ ===== */
function makeWid(){
  return Math.random().toString(36).slice(2,10);
}
const url = new URL(location.href);
let WID = url.searchParams.get("wid");
if(!WID){
  WID = makeWid();
  url.searchParams.set("wid",WID);
  history.replaceState(null,"",url.toString());
}
const STORE_KEY = "kitty-med-final__"+WID;

/* ===== çŠ¶æ€ ===== */
const state = JSON.parse(localStorage.getItem(STORE_KEY)) || {
  theme:"kitty",
  decor:true,
  motion:true,
  meds:[]
};

function save(){
  localStorage.setItem(STORE_KEY,JSON.stringify(state));
}

/* ===== UI ===== */
function render(){
  document.documentElement.dataset.theme = state.theme;
  document.documentElement.classList.toggle("decor-off",!state.decor);
  document.documentElement.classList.toggle("motion-off",!state.motion);

  themeSel.value = state.theme;
  decorToggle.checked = state.decor;
  motionToggle.checked = state.motion;

  medList.innerHTML = "";
  state.meds.forEach((m,i)=>{
    const div=document.createElement("div");
    div.className="row";
    div.innerHTML=`<input type="checkbox" ${m.done?"checked":""}
      onchange="toggleMed(${i})">
      <span>${m.name} (${m.dose})</span>`;
    medList.appendChild(div);
  });
}
function toggleMed(i){
  state.meds[i].done=!state.meds[i].done;
  save();render();
}
function addMed(){
  const name=prompt("è¯ç‰©å");
  if(!name)return;
  const dose=prompt("å‰‚é‡","");
  state.meds.push({name,dose,done:false});
  save();render();
}
function backfill(){
  if(confirm("ç¡®è®¤è¡¥å½•è¯¥æ—¥æœŸï¼Ÿ")){
    alert("å·²è®°å½•ï¼ˆç¤ºæ„ï¼‰");
  }
}

/* ===== äº‹ä»¶ ===== */
themeSel.onchange=e=>{state.theme=e.target.value;save();render();}
decorToggle.onchange=e=>{state.decor=e.target.checked;save();render();}
motionToggle.onchange=e=>{state.motion=e.target.checked;save();render();}

today.textContent=new Date().toLocaleDateString();
render();
</script>
</body>
</html>

